# 프론트엔드(React) 바이브코딩 에이전트 지시문

이 저장소의 백엔드(`server/`)는 **템플릿처럼 재사용**할 수 있습니다. 새 React 프론트를 붙일 때는 아래 **규약(계약)** 을 반드시 지키세요. 이 문서는 “프론트만 새로 만들고, 백엔드는 그대로 붙이는” 작업을 위한 체크리스트입니다.

## 목표

- **백엔드**: `server/server.js` (Express) + `/api-proxy/**`(Gemini HTTP/WS 프록시) + 정적 파일 서빙
- **프론트**: 어떤 React 프로젝트든 가능(바이브 코딩), 단 **빌드 산출물 위치 규약**을 맞출 것
- **배포**: `Dockerfile`로 컨테이너 빌드 → 컨테이너 실행 시 `node server.js`

## 반드시 지켜야 하는 계약(가장 중요)

- **프론트 빌드 스크립트**: 저장소 루트에서 `npm run build`가 성공해야 함
- **빌드 산출물 경로**: `npm run build` 결과가 **루트의 `dist/` 폴더**에 생성되어야 함
  - 이유: `Dockerfile`이 `/app/dist`를 최종 이미지의 `./dist`로 복사하고, `server/server.js`가 `dist/`를 정적으로 서빙함

## 반드시 포함해야 하는 백엔드 템플릿 파일

아래는 프론트를 갈아끼워도 그대로 가져가야 하는 백엔드 템플릿입니다.

- `Dockerfile`
- `server/`
  - `server/server.js` (서버 엔트리포인트)
  - `server/package.json` (서버 의존성/실행 스크립트)
  - `server/public/` (서비스워커/보조 스크립트 제공; 현재 `server.js`가 경로를 사용함)

## 프론트엔드(React) 프로젝트를 붙이는 방법 (권장 흐름)

1. 저장소 루트에 React 프로젝트를 둔다.
   - 예: `App.tsx`, `index.tsx`, `vite.config.ts`, `package.json` 등은 루트에 위치
2. 루트 `package.json`에 아래가 충족되도록 만든다.
   - `scripts.build`가 존재하고 `npm run build`가 성공
   - 빌드 결과가 `dist/`로 떨어짐
3. 프론트에서 백엔드 프록시를 호출할 때는 **상대경로**로 `/api-proxy/...`를 사용한다.
   - 배포 환경에서 프론트와 백엔드가 같은 오리진(동일 도메인/포트)로 동작하도록 하는 것이 목적

## 로컬/배포 환경 변수

- 백엔드가 프록시를 활성화하려면 아래 중 하나가 필요함:
  - `GEMINI_API_KEY` 또는 `API_KEY`
- 포트:
  - 백엔드는 `PORT` 환경변수가 있으면 그 값을 사용하고, 없으면 3000 사용

## 빠른 검증 체크리스트

- `npm run build` 실행 후 **루트에 `dist/index.html`이 생긴다**
- 컨테이너 실행 시 서버 로그에 `Server listening on port ...`가 출력된다
- 브라우저에서 `/` 접속 시 정적 프론트가 서빙된다(또는 `dist/index.html`이 없으면 placeholder로 폴백)
- `/api-proxy/**` 경로로 요청이 들어오면 서버가 외부 API로 프록시한다(키가 없으면 제한될 수 있음)

## 주의사항(실수 방지)

- 빌드 산출물이 `build/` 같은 다른 폴더로 떨어지면 현재 템플릿과 **호환되지 않음** → 반드시 `dist/`로 맞출 것
- 백엔드 템플릿을 “서버만” 최소화하려면 `server/public/`도 같이 가져가는 것을 권장(현재 루트 라우트/서비스워커 제공과 연관)

